<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1, user-scalable=no, viewport-fit=cover"
    />
    <title>Dallin Hatch Game</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #222;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center; /* Changed to center */
            padding-top: 0;      /* Removed top padding */
            width: 100%;
            position: relative;
        }
        #bg-bubbles { display: none !important; } /* Hide old bubbles if present */
        #bg-blobs {
            position: fixed;
            top: 0; left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0;
            pointer-events: none;
            display: block;
            filter: blur(32px) brightness(0.9) saturate(1.1);
            opacity: 0.85;
            transition: opacity 0.3s;
        }
        #phaser-game {
            width: 100%;
            max-width: 1200px;
            height: 100%;
            max-height: 450px;   /* Added max height */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }
        canvas {
            display: block;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            max-height: 100vh;    /* Added max height */
        }
        #fullscreen-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.3);
            border: none;
            border-radius: 5px;
            padding: 8px;
            cursor: pointer;
            display: none;
        }
        /* Fullscreen adjustments */
        body.fullscreen {
            padding: 0;
            align-items: center;
        }
        body.fullscreen #phaser-game {
            max-width: 1200px;  /* Still maintain max width */
            margin: auto;
        }
        /* Hide fullscreen button when in fullscreen mode */
        body.fullscreen #fullscreen-btn {
            display: none !important;
        }
    </style>
    <script src="phaser.min.js"></script>
</head>
<body>
    <canvas id="bg-blobs"></canvas>
    <button id="fullscreen-btn">ðŸ“± Fullscreen</button>
    <div id="phaser-game"></div>
    <script src="game.js"></script>
    <script>
    // --- Blobs Background Effect ---
    (function() {
        const palette = [
            "#3a5c4d", // deep green (tree)
            "#6fa18b", // lighter green
            "#7b7b9b", // muted purple (bg)
            "#b7c7a3", // light green/gray
            "#a3a3c7", // light purple/gray
            "#535353", // game bg
            "#222",    // dark bg
            "#b6b6b6"  // light gray
        ];
        const canvas = document.getElementById('bg-blobs');
        const ctx = canvas.getContext('2d');
        let width = window.innerWidth, height = window.innerHeight;

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', resize);
        resize();

        const BLOBS = [];
        const BLOB_COUNT = 10;
        const BLOB_MIN_RADIUS = 120;
        const BLOB_MAX_RADIUS = 320;
        const BLOB_MIN_SPEED = 0.06;
        const BLOB_MAX_SPEED = 0.18;
        const BLOB_MIN_ALPHA = 0.10;
        const BLOB_MAX_ALPHA = 0.22;

        function randomBlob() {
            const r = Math.random() * (BLOB_MAX_RADIUS - BLOB_MIN_RADIUS) + BLOB_MIN_RADIUS;
            const x = Math.random() * width;
            const y = Math.random() * height;
            const speed = (Math.random() - 0.5) * (BLOB_MAX_SPEED - BLOB_MIN_SPEED) + (Math.random() < 0.5 ? -BLOB_MIN_SPEED : BLOB_MIN_SPEED);
            const angle = Math.random() * Math.PI * 2;
            const color = palette[Math.floor(Math.random() * palette.length)];
            const alpha = Math.random() * (BLOB_MAX_ALPHA - BLOB_MIN_ALPHA) + BLOB_MIN_ALPHA;
            return {
                x, y, r, color, alpha,
                vx: Math.cos(angle) * speed,
                vy: Math.sin(angle) * speed,
                drift: (Math.random()-0.5)*0.08,
                phase: Math.random()*Math.PI*2
            };
        }

        for (let i = 0; i < BLOB_COUNT; i++) {
            BLOBS.push(randomBlob());
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            for (let b of BLOBS) {
                // Animate position
                b.x += b.vx + Math.sin(Date.now()/3000 + b.phase) * b.drift;
                b.y += b.vy + Math.cos(Date.now()/4000 + b.phase) * b.drift;

                // Wrap around edges for seamless flow
                if (b.x < -b.r) b.x = width + b.r;
                if (b.x > width + b.r) b.x = -b.r;
                if (b.y < -b.r) b.y = height + b.r;
                if (b.y > height + b.r) b.y = -b.r;

                ctx.save();
                ctx.globalAlpha = b.alpha;
                ctx.beginPath();
                ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
                ctx.closePath();
                ctx.fillStyle = b.color;
                ctx.fill();
                ctx.restore();
            }
            requestAnimationFrame(animate);
        }
        animate();
    })();
    </script>
</body>
</html>
